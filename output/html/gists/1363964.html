<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Attempt at polyfilling addEventListener in IE7 via .htc hack</title>
<style>
body { font-family: sans-serif; margin: 20px; line-height: 1.6; background-color: #f4f4f4; color: #333; }
.container { max-width: 800px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
pre { background: #f0f0f0; padding: 1em; border-radius: 5px; overflow-x: auto; border: 1px solid #ddd; }
code { font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 0.9em;}
h1, h2 { border-bottom: 1px solid #eee; padding-bottom: 0.3em;}
a.back-link { display: inline-block; margin-bottom: 20px; color: #007bff; text-decoration: none; }
a.back-link:hover { text-decoration: underline; }
</style>
</head>
<body>
<div class="container">
<a href="../index.html" class="back-link">&laquo; Back to Index</a>
<h1 id="attempt-at-polyfilling-addeventlistener-in-ie7-via-htc-hack">Attempt at polyfilling addEventListener in IE7 via .htc hack</h1>

<h2 id="ie7-js">IE7.js</h2>

<pre><code class="language-javascript">Element = function(){};
</code></pre>

<h2 id="ie-fix-htc">ie_fix.htc</h2>

<pre><code class="language-text">&lt;PUBLIC:COMPONENT&gt;
    &lt;PUBLIC:METHOD NAME=&quot;addEventListener&quot; INTERNALNAME=&quot;_addEventListener&quot; /&gt;
	&lt;script type=&quot;text/javascript&quot;&gt;
        var element = new Element;
        _addEventListener = element.addEventListener;
    &lt;/script&gt;
&lt;/PUBLIC:COMPONENT&gt;
</code></pre>

<h2 id="index-html">index.html</h2>

<pre><code class="language-html">&lt;!doctype html&gt;
&lt;html dir=&quot;ltr&quot; lang=&quot;en&quot;&gt;
	&lt;head&gt;
		&lt;meta charset=&quot;utf-8&quot;&gt;
		&lt;title&gt;addEventListener Shim&lt;/title&gt;
		&lt;!--[if lte IE 7]&gt;
			&lt;script src=&quot;IE7.js&quot;&gt;&lt;/script&gt;
			&lt;style type=&quot;text/css&quot;&gt;
				* { behavior: url(ie_fix.htc); }
			&lt;/style&gt;
		&lt;![endif]--&gt;
	&lt;/head&gt;
	&lt;body&gt;
	
		&lt;div id=&quot;testelement&quot; class=&quot;testclass&quot;&gt;
			This is my test element
		&lt;/div&gt;
		
		&lt;script type=&quot;text/javascript&quot;&gt;
			// IE8 (provides access to its 'Element' Interface)
			if (window.Element &amp;&amp; !window.addEventListener) {
				window.Element.prototype.addEventListener = function(type, listener, useCapture) {
					this.attachEvent('on' + type, listener);
				}
				
				window.Element.prototype.removeEventListener = function(type, listener, useCapture) {
					this.detachEvent('on' + type, listener);
				}
			}
			
			function test() {
				alert('I\'m the listener for the addEventListener');
				
				testelem.removeEventListener('click', test, false);
			}
			
			var testelem = document.getElementById('testelement');
			
			testelem.addEventListener('click', test, false);
		&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>

</div>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Trapping Shell Signals </title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="../assets/css/styles.css">
</head>
<body>
<div class="container">
<a href="../index.html" class="back-link">&laquo; Back to Index</a>
<div class="markdown-content">
<h1 id="trapping-shell-signals">Trapping Shell Signals</h1>

<p><a href="https://gist.github.com/Integralist/29024a8de49dcdf5ba9b24927e15cf05" target="_blank">View original Gist on GitHub</a></p>

<p><strong>Tags:</strong> #shell</p>

<h2 id="trapping-shell-signals-1">Trapping Shell Signals</h2>

<pre><code class="language-shell">#!/usr/bin/env bash

cleanup() {
  echo &quot;&gt;&gt;&gt; cleanup called (reason: $1)&quot;
}

# Trap EXIT, INT, TERM
# In the following code we're passing the 'signal' as an argument to the cleanup function.
#
# trap 'cleanup EXIT' EXIT
# trap 'cleanup INT' INT
# trap 'cleanup TERM' TERM

# INT/TERM would normally stop the script immediately.
# But when you trap them, you replace the default action with whatever you tell the shell to do.
# You need to explicitly tell the shell to exit after cleanup, e.g.:
trap 'cleanup INT; exit 130' INT    # 130 is the conventional exit code for SIGINT
trap 'cleanup TERM; exit 143' TERM  # 143 = 128 + 15 (SIGTERM)
trap 'cleanup EXIT' EXIT

echo &quot;PID $$ running. Try:&quot;
echo &quot;  1) Let it finish normally&quot;
echo &quot;  2) Press Ctrl+C&quot;
echo &quot;  3) Run: kill -TERM $$&quot;
echo

# Simulate doing some work
for i in {1..10}; do
  echo &quot;Working... $i&quot;
  sleep 1
done

echo &quot;Script finished normally.&quot;
</code></pre>
</div>
<link rel="stylesheet" href="../assets/css/highlights/github.min.css">
<script src="../assets/js/highlight.min.js"></script>
<script src="../assets/js/notes.js" defer></script>
<script>hljs.highlightAll();</script>

</div>
</body>
</html>